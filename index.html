<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>HALAL ROULETTE</title>

<style>
body{
  font-family:Arial;
  padding:28px;
  background:#0b1220;
  color:#e7eefc;
  overflow-x:hidden;
}
.card{
  background:#111a2e;
  border-radius:14px;
  padding:20px;
  max-width:900px;
  margin:auto;
}
h1{text-align:center;font-size:30px;}
.row{display:flex;gap:12px;flex-wrap:wrap;margin:12px 0;}
input,select{
  padding:10px;
  border-radius:10px;
  background:#1b2640;
  color:white;
  border:1px solid #333;
}
select{background:white;color:black;}
button{
  padding:10px 16px;
  border-radius:12px;
  border:none;
  cursor:pointer;
  background:linear-gradient(180deg,#3b82f6 0%, #2563eb 100%);
  color:white;
  font-weight:700;
}
button:disabled{opacity:0.5;cursor:not-allowed;}

#result{
  font-size:70px;
  margin:25px 0;
  font-weight:800;
  text-align:center;
}
.red{color:#ff4d4d;}
.black{color:white;}

.pill{
  padding:8px 12px;
  border-radius:999px;
  background:#1b2640;
}

.stats,.roll-history{
  margin-top:20px;
  padding:14px;
  background:#0e172a;
  border-radius:12px;
}

.roll-item{
  display:inline-block;
  margin:4px;
  padding:6px 10px;
  border-radius:8px;
  font-weight:bold;
}
.roll-item.red{background:#ff4d4d;}
.roll-item.black{background:#333;}
</style>
</head>

<body>
<div class="card">
<h1>HALAL ROULETTE</h1>

<div class="row">
<div class="pill">Balance: $<span id="balance">100</span></div>
<div class="pill">Last payout: $<span id="payout">0</span></div>
</div>

<div class="row">
<input id="bet" type="number" placeholder="Bet amount">
<select id="guessColor">
<option value="">Color</option>
<option value="red">Red</option>
<option value="black">Black</option>
</select>
<select id="guessParity">
<option value="">Odd/Even</option>
<option value="odd">Odd</option>
<option value="even">Even</option>
</select>
</div>

<div class="row">
<button id="play">Play</button>
<button id="reset">Reset</button>
</div>

<div id="result">—</div>
<div id="message"></div>

<div class="stats">
<h3>Stats</h3>
<div>Total Spins: <span id="totalSpins">0</span></div>
<div>Total Wins: <span id="totalWins">0</span></div>
<div>Win Rate: <span id="winRate">0%</span></div>
</div>

<div class="roll-history">
<h3>Last 10 Rolls</h3>
<div id="lastRolls"></div>
</div>
</div>

<!-- AUDIO -->
<audio id="bgMusic" src="background.mp3" loop></audio>
<audio id="spinSound" src="spin.mp3"></audio>
<audio id="loseSound" src="lose.mp3"></audio>
<audio id="win1" src="win1.mp3"></audio>
<audio id="win2" src="win2.mp3"></audio>
<audio id="win3" src="win3.mp3"></audio>
<audio id="win4" src="win4.mp3"></audio>
<audio id="win5" src="win5.mp3"></audio>
<audio id="win6" src="win6.mp3"></audio>
<audio id="win7" src="win7.mp3"></audio>

<script>
const slots = Array.from({length:36},(_,i)=>(i+1).toString());
const redSet=new Set(["1","3","5","7","9","12","14","16","18","19","21","23","25","27","30","32","34","36"]);
function getColor(s){return redSet.has(s)?"red":"black";}
function getParity(s){return Number(s)%2===0?"even":"odd";}
function pick(){return slots[Math.floor(Math.random()*slots.length)];}

let balance=100,totalSpins=0,totalWins=0,lastTen=[],isSpinning=false;
let audioUnlocked=false;

const balanceEl=document.getElementById("balance");
const payoutEl=document.getElementById("payout");
const resultEl=document.getElementById("result");
const msgEl=document.getElementById("message");

const bgMusic=document.getElementById("bgMusic");
const spinSound=document.getElementById("spinSound");
const loseSound=document.getElementById("loseSound");

const winSounds=[win1,win2,win3,win4,win5,win6,win7];

// Audio levels
bgMusic.volume=0.15;
spinSound.volume=0.35;
loseSound.volume=0.6;
winSounds.forEach(w=>w.volume=1.0);

// Safari unlock
function unlockAudio(){
 if(audioUnlocked) return;
 audioUnlocked=true;

 const all=[bgMusic,spinSound,loseSound,...winSounds];
 all.forEach(s=>{
   s.play().then(()=>{
     s.pause();
     s.currentTime=0;
   }).catch(()=>{});
 });

 bgMusic.play();
}
document.addEventListener("click", unlockAudio);

function updateStats(){
 document.getElementById("totalSpins").textContent=totalSpins;
 document.getElementById("totalWins").textContent=totalWins;
 let rate=totalSpins?((totalWins/totalSpins)*100).toFixed(1):0;
 document.getElementById("winRate").textContent=rate+"%";
}

function updateRollHistory(){
 const c=document.getElementById("lastRolls");
 c.innerHTML="";
 lastTen.slice(-10).reverse().forEach(r=>{
  const d=document.createElement("div");
  d.className="roll-item "+r.color;
  d.textContent=r.number;
  c.appendChild(d);
 });
}

function spin(){
if(isSpinning)return;

const bet=Number(document.getElementById("bet").value);
const gColor=document.getElementById("guessColor").value;
const gParity=document.getElementById("guessParity").value;

if(!bet||bet<=0||bet>balance){msgEl.textContent="Invalid bet";return;}
if(!gColor&&!gParity){msgEl.textContent="Pick a guess";return;}

isSpinning=true;
document.getElementById("play").disabled=true;

balance-=bet;
balanceEl.textContent=balance;
totalSpins++;
updateStats();

spinSound.currentTime=0;
spinSound.play();

let anim=setInterval(()=>{
 const f=pick();
 resultEl.textContent=f;
 resultEl.className=getColor(f);
},100);

setTimeout(()=>{
 clearInterval(anim);
 spinSound.pause();

 const slot=pick();
 const color=getColor(slot);
 const parity=getParity(slot);

 resultEl.textContent=slot;
 resultEl.className=color;

 let payout=0;
 if(gColor&&gParity){
   if(gColor===color&&gParity===parity)payout=bet*4;
 }else{
   if(gColor===color||gParity===parity)payout=bet*2;
 }

 if(payout>0){
   balance+=payout;
   totalWins++;
   bgMusic.volume=0.05;

   const original=winSounds[Math.floor(Math.random()*winSounds.length)];
   const win=original.cloneNode(true);
   win.volume=1.0;

   win.play().catch(err=>console.log("WIN ERROR:",err));
   win.onended=()=>bgMusic.volume=0.15;
 }else{
   loseSound.currentTime=0;
   loseSound.play();
 }

 balanceEl.textContent=balance;
 payoutEl.textContent=payout;
 msgEl.textContent=payout>0?"You won $"+payout:"You lost $"+bet;

 lastTen.push({number:slot,color:color});
 if(lastTen.length>10)lastTen.shift();

 updateStats();
 updateRollHistory();

 isSpinning=false;
 document.getElementById("play").disabled=false;

},3000);
}

document.getElementById("play").addEventListener("click",spin);
document.getElementById("reset").addEventListener("click",()=>{
 balance=100;
 totalSpins=0;
 totalWins=0;
 lastTen=[];
 balanceEl.textContent=balance;
 payoutEl.textContent=0;
 resultEl.textContent="—";
 msgEl.textContent="Game reset";
 updateStats();
 updateRollHistory();
});

updateStats();
updateRollHistory();
</script>
</body>
</html>
